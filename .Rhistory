x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(top_states_for_each_brand, aes(x = state, y = total_quantity)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(. ~ brand, scales = 'free_x', 'free_y') +
labs(title = "Top States for Each Brand",
x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(top_states_for_each_brand, aes(x = state, y = total_quantity)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(. ~ brand, scales = 'free_x') +
labs(title = "Top States for Each Brand",
x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(top_states_for_each_brand, aes(x = brand, y = total_quantity, fill = state)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Top States for Each Brand",
x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
View(most_popular_brand_by_state)
View(brand_by_state)
top_states_for_each_brand <- brand_by_state |>
group_by(brand) |>
slice_head(n = 2)
View(top_states_for_each_brand)
top_states_for_each_brand <- brand_by_state |>
group_by(total_quantity) |>
slice_head(n = 2)
top_states_for_each_brand <- brand_by_state |>
group_by(total_quantity) |>
head(n = 2)
View(top_states_for_each_brand)
top_states_for_each_brand <- brand_by_state |>
group_by(total_quantity)
View(top_states_for_each_brand)
top_states_for_each_brand <- brand_by_state |>
group_by(brand) |>
head(n = 3)
View(top_states_for_each_brand)
top_states_for_each_brand <- brand_by_state |>
group_by(brand) |>
slice_max(quantity, n = 3)
top_states_for_each_brand <- brand_by_state |>
group_by(brand) |>
slice_max(x, n = 3)
top_states_for_each_brand <- brand_by_state |>
group_by(brand) |>
slice_max(brand, n = 3)
View(top_states_for_each_brand)
top_states_for_each_brand <- brand_by_state |>
group_by(brand) |>
arrange(desc(total_quantity))
View(top_states_for_each_brand)
top_states_for_each_brand <- brand_by_state |>
group_by(brand) |>
arrange(desc(total_quantity)) |>
group_by(state) |>
slice_head(n = 2)
View(top_states_for_each_brand)
top_states_for_each_brand <- brand_by_state |>
group_by(brand) |>
arrange(desc(total_quantity)) |>
group_by(brand) |>
slice_head(n = 2)
View(top_states_for_each_brand)
ggplot(top_states_for_each_brand, aes(x = brand, y = total_quantity, fill = state)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Top States for Each Brand",
x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(top_states_for_each_brand, aes(x = state, y = total_quantity)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(. ~ brand, scales = 'free_x') +
labs(title = "Top States for Each Brand",
x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(top_states_for_each_brand, aes(x = brand, y = total_quantity)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(. ~ state, scales = 'free_x') +
labs(title = "Top States for Each Brand",
x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(top_states_for_each_brand, aes(x = state, y = total_quantity)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(. ~ brand, scales = 'free_x') +
labs(title = "Top States for Each Brand",
x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(top_states_for_each_brand, aes(x = state, y = total_quantity, fill = brand)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Top States for Each Brand",
x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
beer_market <- distinct(age)
beer_market |>
distinct(age)
beer_markets |>
distinct(age)
beer_markets |>
distinct(age)
beer_markets |>
class(age)
class(age)
class(beer_markets$age)
beer_markets |>
unique(age)
beer_markets |>
distinct(age)
beer_markets2 <- beer_markets %>%
mutate(age_numeric = case_when(
age == "<30" ~ 25,
age == "30-39" ~ 35,
age == "40-49" ~ 45,
age == "50+" ~ 55))
beer_by_age <- beer_markets2 |>
group_by(age, age_numeric) |>
summarize(total_quantity = sum(quantity, na.rm = TRUE)) |>
arrange(desc(total_quantity))
View(beer_by_age)
beer_markets |>
distinct(income)
beer_brand_purchases <- beer_markets2 |>
group_by(income, income_numeric, brand) |>
summarize(total_quantity = sum(quantity))
beer_markets |>
distinct(income)
beer_markets2 <- beer_markets %>%
mutate(income_numeric = case_when(
income == "under20k" ~ 20000,
income == "20-60k" ~ 60000,
income == "60-100k" ~ 100000,
income == "100-200k" ~ 200000,
income == "200k+" ~ 500000))
beer_brand_purchases <- beer_markets2 |>
group_by(income, income_numeric, brand) |>
summarize(total_quantity = sum(quantity))
most_popular_brands_by_income <- beer_brand_purchases |>
group_by(income, income_numeric) |>
filter(total_quantity == max(total_quantity)) |>
select(income, income_numeric, brand, total_quantity)
brand_distribution <- beer_brand_purchases |>
group_by(income, income_numeric) |>
mutate(percentage = total_quantity / sum(total_quantity) * 100) |>
arrange(desc(income_numeric))
ggplot(brand_distribution, aes(x = income_numeric, y = percentage, fill = brand)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Income", y = "Percentage") +
scale_x_continuous(
breaks = unique(brand_distribution$income_numeric),
labels = unique(brand_distribution$income)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
beer_quantity <- beer_markets2 |>
group_by(income, income_numeric) |>
summarise(total_quantity = sum(quantity, na.rm = TRUE)) |>
arrange(desc(total_quantity))
ggplot(beer_quantity,
aes(x = income_numeric, y = total_quantity)) +
geom_point() +
geom_line() +
labs(x = "Income", y = "Total Quantity of Beer Bought") +
scale_x_continuous(breaks = beer_quantity$income_numeric, labels = beer_quantity$income) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
beer_promotion <- beer_markets2 |>
select(income, income_numeric, promo)
promo_percentage <- beer_promotion |>
group_by(income, income_numeric) |>
summarize(promo_percent = mean(promo) * 100)
ggplot(promo_percentage,
aes(x = income_numeric, y = promo_percent)) +
geom_point() +
geom_line() +
labs(x = "Income", y = "Percentage Purchased During Promotion") +
scale_x_continuous(breaks = promo_percentage$income_numeric, labels = promo_percentage$income) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
beer_promotion <- beer_markets2 |>
select(income, income_numeric, promo)
promo_percentage <- beer_promotion |>
group_by(income, income_numeric) |>
summarize(promo_percent = mean(promo) * 100)
ggplot(promo_percentage,
aes(x = income_numeric, y = promo_percent)) +
geom_point() +
geom_line() +
labs(x = "Income", y = "Percentage Purchased During Promotion") +
scale_x_continuous(breaks = promo_percentage$income_numeric, labels = promo_percentage$income) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
beer_promotion <- beer_markets2 |>
select(income, income_numeric, promo)
promo_percentage <- beer_promotion |>
group_by(income, income_numeric) |>
summarize(promo_percent = mean(promo) * 100)
ggplot(promo_percentage,
aes(x = income_numeric, y = promo_percent)) +
geom_point() +
geom_line() +
labs(x = "Income", y = "Percentage Purchased During Promotion") +
scale_x_continuous(breaks = promo_percentage$income_numeric, labels = promo_percentage$income) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(beer_quantity,
aes(x = income_numeric, y = total_quantity)) +
geom_point() +
geom_line() +
labs(x = "Income", y = "Total Quantity of Beer Bought") +
scale_x_continuous(breaks = beer_quantity$income_numeric, labels = beer_quantity$income) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
brand_by_state <- beer_markets |>
group_by(state, brand) |>
summarize(total_quantity = sum(quantity))
most_popular_brand_by_state <- brand_by_state |>
group_by(state) |>
filter(total_quantity == max(total_quantity)) |>
select(state, brand, total_quantity) |>
arrange(desc(total_quantity))
top_states_for_each_brand <- brand_by_state |>
group_by(brand) |>
arrange(desc(total_quantity)) |>
group_by(brand) |>
slice_head(n = 2)
beer_quantity_by_state <- beer_markets |>
group_by(state) |>
summarize(total_quantity = sum(quantity)) |>
arrange(desc(total_quantity))
most_popular_state_for_brand <- brand_by_state |>
group_by(brand) |>
filter(total_quantity == max(total_quantity))
ggplot(beer_quantity_by_state, aes(x = state, y = total_quantity)) +
geom_bar(stat = "identity", width = 0.7) +
labs(title = "Total Quantity of Beers Purchased by State",
x = "State",
y = "Total Quantity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(top_states_for_each_brand, aes(x = brand, y = total_quantity, fill = state)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Top States for Each Brand",
x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
beer_markets2 <- beer_markets2 |>
mutate(age_numeric = case_when(
age == "<30" ~ 25,
age == "30-39" ~ 35,
age == "40-49" ~ 45,
age == "50+" ~ 55))
beer_by_age <- beer_markets2 |>
group_by(age, age_numeric) |>
summarize(total_quantity = sum(quantity, na.rm = TRUE)) |>
arrange(desc(total_quantity))
View(beer_by_age)
ggplot(beer_by_age,
aes(x = age, y = total_quantity)) +
geom_point() +
geom_line()
ggplot(beer_by_age,
aes(x = age, y = total_quantity)) +
geom_point()
ggplot(promo_percentage,
aes(x = income_numeric, y = promo_percent)) +
geom_point() +
geom_line() +
labs(title = "Promorion Percentage Based on Income" x = "Income", y = "Percentage") +
ggplot(promo_percentage,
aes(x = income_numeric, y = promo_percent)) +
geom_point() +
geom_line() +
labs(title = "Promotion Percentage Based on Income", x = "Income", y = "Percentage") +
scale_x_continuous(breaks = promo_percentage$income_numeric, labels = promo_percentage$income) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(promo_percentage,
aes(x = income_numeric, y = promo_percent)) +
geom_point() +
geom_line() +
labs(title = "Promotion Percentage Based on Income", x = "Income", y = "Percentage") +
scale_x_continuous(breaks = promo_percentage$income_numeric, labels = promo_percentage$income) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(beer_quantity,
aes(x = income_numeric, y = total_quantity)) +
geom_point() +
geom_line() +
labs(title = "Quantity of Beer Bought Based On Income", x = "Income", y = "Total Quantity") +
scale_x_continuous(breaks = beer_quantity$income_numeric, labels = beer_quantity$income) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(beer_quantity,
aes(x = income_numeric, y = total_quantity)) +
geom_point() +
geom_line() +
labs(title = "Quantity of Beer Purchased Based On Income", x = "Income", y = "Total Quantity") +
scale_x_continuous(breaks = beer_quantity$income_numeric, labels = beer_quantity$income) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(promo_percentage,
aes(x = income_numeric, y = promo_percent)) +
geom_point() +
geom_line() +
labs(title = "Promotion Purchases Based on Income", x = "Income", y = "Percentage") +
scale_x_continuous(breaks = promo_percentage$income_numeric, labels = promo_percentage$income) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(promo_percentage,
aes(x = income_numeric, y = promo_percent)) +
geom_point() +
geom_line() +
labs(title = "Promotion Purchases Based On Income", x = "Income", y = "Percentage") +
scale_x_continuous(breaks = promo_percentage$income_numeric, labels = promo_percentage$income) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(brand_distribution, aes(x = income_numeric, y = percentage, fill = brand)) +
geom_bar(stat = "identity", position = "stack") +
labs(title = "Most Purchased Brands", x = "Income", y = "Percentage") +
scale_x_continuous(
breaks = unique(brand_distribution$income_numeric),
labels = unique(brand_distribution$income)) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(brand_distribution, aes(x = income_numeric, y = percentage, fill = brand)) +
geom_bar(stat = "identity", position = "stack") +
labs(title = "Most Commonly Purchased Brands", x = "Income", y = "Percentage") +
scale_x_continuous(
breaks = unique(brand_distribution$income_numeric),
labels = unique(brand_distribution$income)) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(brand_distribution, aes(x = income_numeric, y = percentage, fill = brand)) +
geom_bar(stat = "identity", position = "stack") +
labs(title = "Most Commonly Purchased Brands Based On Income", x = "Income", y = "Percentage") +
scale_x_continuous(
breaks = unique(brand_distribution$income_numeric),
labels = unique(brand_distribution$income)) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(top_states_for_each_brand, aes(x = brand, y = total_quantity, fill = state)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Top States for Each Brand", x = "Brand", y = "Total Quantity", fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(brand_distribution, aes(x = income_numeric, y = percentage, fill = brand)) +
geom_bar(stat = "identity", position = "stack") +
labs(title = "Most Commonly Purchased Brands Based On Income",
x = "Income",
y = "Percentage") +
scale_x_continuous(
breaks = unique(brand_distribution$income_numeric),
labels = unique(brand_distribution$income)) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
beer_quantity <- beer_markets2 |>
group_by(income, income_numeric) |>
summarise(total_quantity = sum(quantity, na.rm = TRUE)) |>
arrange(desc(total_quantity))
ggplot(beer_quantity,
aes(x = income_numeric, y = total_quantity)) +
geom_point() +
geom_line() +
labs(title = "Quantity of Beer Purchased Based On Income",
x = "Income",
y = "Total Quantity") +
scale_x_continuous(breaks = beer_quantity$income_numeric, labels = beer_quantity$income) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
beer_quantity <- beer_markets2 |>
group_by(income, income_numeric) |>
summarise(total_quantity = sum(quantity, na.rm = TRUE)) |>
arrange(desc(total_quantity))
ggplot(beer_quantity,
aes(x = income_numeric, y = total_quantity)) +
geom_point() +
geom_line() +
labs(title = "Quantity of Beer Purchased Based On Income",
x = "Income",
y = "Total Quantity") +
scale_x_continuous(breaks = beer_quantity$income_numeric, labels = beer_quantity$income) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(promo_percentage,
aes(x = income_numeric, y = promo_percent)) +
geom_point() +
geom_line() +
labs(title = "Promotion Purchases Based On Income",
x = "Income",
y = "Percentage") +
scale_x_continuous(breaks = promo_percentage$income_numeric, labels = promo_percentage$income) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(beer_quantity_by_state, aes(x = state, y = total_quantity)) +
geom_bar(stat = "identity", width = 0.7) +
labs(title = "Total Quantity of Beers Purchased by State",
x = "State",
y = "Total Quantity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(top_states_for_each_brand, aes(x = brand, y = total_quantity, fill = state)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Top States for Each Brand",
x = "Brand",
y = "Total Quantity",
fill = "State") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(beer_by_age,
aes(x = age, y = total_quantity)) +
geom_point() +
labs(title = "Beers Purchased By Age",
x = "Age",
y = "Quantity")
ggplot(beer_by_age,
aes(x = age, y = total_quantity)) +
geom_point() +
labs(title = "Beers Purchased By Age",
x = "Age",
y = "Quantity") +
theme_minimal()
brand_by_age <- beer_markets2 |>
group_by(age, age_numeric, brand) |>
summarize(total_quantity = sum(quantity, na.rm = TRUE)) |>
arrange(age, desc(total_quantity))
View(brand_by_age)
brand_by_age <- beer_markets2 |>
group_by(age, age_numeric, brand) |>
summarize(total_quantity = sum(quantity, na.rm = TRUE)) |>
arrange(age_numeric, desc(total_quantity))
most_popular_by_age <- brand_by_age |>
group_by(age, age_numeric) |>
slice_max(order_by = total_quantity, n = 1)
View(most_popular_by_age)
print(most_popular_by_age)
most_popular_by_age <- brand_by_age |>
group_by(age, age_numeric) |>
arrange(age_numeric, desc(total_quantity)) |>
slice_max(order_by = total_quantity, n = 1)
print(most_popular_by_age)
most_popular_by_age <- brand_by_age |>
group_by(age, age_numeric) |>
arrange(desc(age_numeric)) |>
slice_max(order_by = total_quantity, n = 1)
print(most_popular_by_age)
most_popular_by_age <- brand_by_age |>
group_by(age, age_numeric) |>
slice_max(order_by = total_quantity, n = 1)
print(most_popular_by_age)
ggplot(brand_distribution, aes(x = income_numeric, y = percentage, fill = brand)) +
geom_bar(stat = "identity", position = "stack") +
labs(title = "Most Commonly Purchased Brands Based On Income",
x = "Income",
y = "Percentage") +
scale_x_continuous(
breaks = unique(brand_distribution$income_numeric),
labels = unique(brand_distribution$income)) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(beer_quantity,
aes(x = income_numeric, y = total_quantity)) +
geom_point() +
geom_line() +
labs(title = "Quantity of Beer Purchased Based On Income",
x = "Income",
y = "Total Quantity") +
scale_x_continuous(breaks = beer_quantity$income_numeric,
labels = beer_quantity$income) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(promo_percentage,
aes(x = income_numeric, y = promo_percent)) +
geom_point() +
geom_line() +
labs(title = "Promotion Purchases Based On Income",
x = "Income",
y = "Percentage") +
scale_x_continuous(breaks = promo_percentage$income_numeric,
labels = promo_percentage$income) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(brand_by_age,
aes(x = age_numeric, y = total_quantity, color = brand)) +
geom_point() +
geom_line() +
labs(title = "Most Popular Brands For Each Age",
x = "Age",
y = "Quantity") +
scale_x_continuous(breaks = brand_by_age$age_numeric,
labels = brand_by_age$age) +
theme_minimal()
