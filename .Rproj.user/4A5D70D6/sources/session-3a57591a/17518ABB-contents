---
title: "Homework 4"
author: "Brett Patmore"
date: "2024-05-10"
categories: [homework, code, analysis]
image: "hw4.png"

execute: 
  warning: false
  message: false
  
toc: true
---
```{r}
#| include: false

library(knitr)
library(rmarkdown)
library(tidyverse)
library(skimr)
library(ggthemes)
library(hrbrthemes)

theme_set(theme_ipsum()+
          theme(strip.background =element_rect(fill="lightgray"),
                axis.title.x  = element_text(angle = 0,
                                            size = rel(1.5),
                                            margin = margin(10,0,0,0)),
                axis.title.y  = element_text(angle = 0,
                                            size = rel(1.5),
                                            margin = margin(0,10,0,0))
                )
          )
```

Let's analyze the `homework 4` data:

```{r}
health_cust <- read_csv('https://bcdanl.github.io/data/custdata_rev.csv')
```

```{r}
#| echo: false
#| eval: true
rmarkdown::paged_table(health_cust)
```

<br>

# Housing Type Statistics
```{r}
housing_type_statistics <- health_cust |> 
  group_by(housing_type) |> 
  summarize(
    mean = mean(income, na.rm = TRUE),
    SD = sd(income, na.rm = TRUE),
    Q1 = quantile(income, probs = 0.25, na.rm = TRUE),
    Median = median(income, na.rm = TRUE),
    Q3 = quantile(income, probs = 0.75, na.rm = TRUE), 
    Max = max(income, na.rm = TRUE)
  )
```


# State of Residency Statistics
```{r}
state_statistics <- health_cust |> 
  group_by(state_of_res) |> 
  summarize(
    mean = mean(income, na.rm = TRUE),
    SD = sd(income, na.rm = TRUE),
    Q1 = quantile(income, probs = 0.25, na.rm = TRUE),
    Median = median(income, na.rm = TRUE),
    Q3 = quantile(income, probs = 0.75, na.rm = TRUE), 
    Max = max(income, na.rm = TRUE)
  )
```


# Marital Status Statistics
```{r}
marital_statistics <- health_cust |> 
  group_by(marital_status) |> 
  summarize(
    mean = mean(income, na.rm = TRUE),
    SD = sd(income, na.rm = TRUE),
    Q1 = quantile(income, probs = 0.25, na.rm = TRUE),
    Median = median(income, na.rm = TRUE),
    Q3 = quantile(income, probs = 0.75, na.rm = TRUE), 
    Max = max(income, na.rm = TRUE)
  )
```


# Income by Housing Type
```{r}
income_by_housing_type <- health_cust |> 
  group_by(income, housing_type) |> 
  summarize(Count = n(), .groups = "drop") |> 
  group_by(housing_type) |> 
  arrange(desc(income))
```
