---
title: Homework 4
subtitle: "health_cust Data Analytics"
author: 
  - name: Brett Patmore
date: 4/30/24

execute: 
  echo: true    # true false
  eval: true    # true false
  warning: false    # true false
  message: false    # true false
  fig-width: 9
  # fig-height: 5
  
format: 
  html:
    toc: true    # true false
    number-sections: true    # true false
    code-fold: show    # true false show       # https://quarto.org/docs/output-formats/html-code.html
    code-tools: true    # true false
    highlight-style: atom-one        # atom-one tango espresso   # https://quarto.org/docs/output-formats/html-code.html#highlighting
---


```{r setup}
#| include: false
library(tidyverse)
library(hrbrthemes)
library(skimr)
library(DT)

```

# health_cust data.frame

```{r}
health_cust <- read_csv('https://bcdanl.github.io/data/custdata_rev.csv')
```
# Question 2

- Create a blog post featuring data analysis on the `health_cust` data.frame and publish it on your GitHub website using your Quarto document for Homework 2.
  - If you have not completed on Homework 2, please take this opportunity to do so.

```{r}
health_cust <- read_csv(
  'https://bcdanl.github.io/data/custdata_rev.csv'
)
```


# Housing Type Statistics
## The mean, standard deviation, first quartile, median, third quartile, and maximum of 'income' for each 'housing_type'.
```{r}
housing_type_statistics <- health_cust |> 
  group_by(housing_type) |> 
  summarize(
    mean = mean(income, na.rm = TRUE),
    SD = sd(income, na.rm = TRUE),
    Q1 = quantile(income, probs = 0.25, na.rm = TRUE),
    Median = median(income, na.rm = TRUE),
    Q3 = quantile(income, probs = 0.75, na.rm = TRUE), 
    Max = max(income, na.rm = TRUE)
  )
```


# State of Residency Statistics
```{r}
state_statistics <- health_cust |> 
  group_by(state_of_res) |> 
  summarize(
    mean = mean(income, na.rm = TRUE),
    SD = sd(income, na.rm = TRUE),
    Q1 = quantile(income, probs = 0.25, na.rm = TRUE),
    Median = median(income, na.rm = TRUE),
    Q3 = quantile(income, probs = 0.75, na.rm = TRUE), 
    Max = max(income, na.rm = TRUE)
  )
```


# Marital Status Statistics
```{r}
marital_statistics <- health_cust |> 
  group_by(marital_status) |> 
  summarize(
    mean = mean(income, na.rm = TRUE),
    SD = sd(income, na.rm = TRUE),
    Q1 = quantile(income, probs = 0.25, na.rm = TRUE),
    Median = median(income, na.rm = TRUE),
    Q3 = quantile(income, probs = 0.75, na.rm = TRUE), 
    Max = max(income, na.rm = TRUE)
  )
```


# Income by housing type
```{r}
income_by_housing_type <- health_cust |> 
  group_by(income, housing_type) |> 
  summarize(Count = n(), .groups = "drop") |> 
  group_by(housing_type) |> 
  arrange(desc(income))
```

